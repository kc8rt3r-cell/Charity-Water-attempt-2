<!DOCTYPE html>
<html lang="en">
<head>
    <!-- This section contains information about the page (not visible to visitors) -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>charity: water - Bringing Clean Water to the World</title> <!-- This appears in the browser tab -->
    <link rel="stylesheet" href="styles.css?v=2"> <!-- This connects to the styling file -->
</head>
<body>
    <!-- HEADER SECTION - Appears at the top of every page (includes navigation) -->
    <header class="header">
        <img src="img/images/Logos/charitywater_logo_horizontal_BlackText.png" alt="Charity Water Logo">

        <!-- NAVIGATION MENU - placed inside header -->
        <nav class="navigation">
            <a href="#home" class="nav-link">Home</a>
            <a href="#about" class="nav-link">About</a>
            <a href="#services" class="nav-link">Services</a>
            <a href="#contact" class="nav-link">Contact</a>
        </nav>
    </header>

    <!-- LEFT SIDE BOX -->
    <div class="left-box">
        <img src="img/images/Main image/20170302-IMG_6802-3.jpg" alt="Regular Image" class="left-box-image is-visible" id="leftBoxImage">
        <img src="img/images/Main image/20170302-IMG_6802-3.jpg" alt="Regular Image" class="left-box-image" id="leftBoxImageNext">
    </div>

    <!-- YELLOW STRIP ABOVE TEXT BOX -->
    <div class="top-strip"></div>

    <!-- BLACK RECTANGLE ABOVE BUTTONS -->
    <div class="top-rectangle">Changing the World One Sip at a Time!</div>

    <!-- RECTANGLE BELOW MAIN BLACK BOX -->
    <div class="sub-rectangle" id="story-section"></div>

    <!-- ACTION BOXES -->
    <div class="action-row">
        <div class="center-box">
            <img src="img/images/Logos/jerry_can_yellow.png" alt="Donate" class="center-box-image">
            <span class="center-box-text">Donate!</span>
            <img src="img/images/Logos/jerry_can_yellow.png" alt="Donate" class="center-box-image">
        </div>

        <div class="right-box">
            <img src="img/images/1F9D1-200D-1F91D-200D-1F9D1.svg" alt="Volunteer" class="right-box-icon">
            <span>Volunteer!</span>
            <img src="img/images/1F9D1-200D-1F91D-200D-1F9D1.svg" alt="Volunteer" class="right-box-icon">
        </div>

        <a class="action-link" href="#story-section">
            <div class="extra-box">
                <img src="img/images/1F4D6.svg" alt="Open Book" class="extra-box-image">
                <span class="extra-box-text">There Story!</span>
                <img src="img/images/1F4D6.svg" alt="Open Book" class="extra-box-image">
            </div>
        </a>
    </div>

    <!-- FOOTER SECTION - Appears at the bottom of every page -->
    <footer class="footer">
        <p>&copy; 2026 charity: water. All rights reserved.</p>
        <p>Bringing clean water to everyone on the planet.</p>
        <div class="social-icons" aria-label="Social media">
            <a href="#" aria-label="YouTube">
                <img src="img/images/E044.svg" alt="YouTube">
            </a>
            <a href="#" aria-label="LinkedIn">
                <img src="img/images/E046.svg" alt="LinkedIn">
            </a>
            <a href="#" aria-label="Snapchat">
                <svg viewBox="0 0 24 24" role="img" aria-hidden="true"><path d="M12 3.5c2.6 0 4.7 2.1 4.7 4.7 0 .9-.1 1.5.2 2 .4.6 1.2.7 1.6 1 .5.3.9.7.8 1.2-.2.7-1.2.9-2 1.2-.6.2-1.2.4-1.4.9-.2.6.1 1.3.4 1.9.2.4.4.8.4 1.1 0 .7-.8 1-1.7 1.2-.8.2-1.7.3-2.3.8-.4.3-.7.8-1.7.8s-1.3-.5-1.7-.8c-.6-.5-1.5-.6-2.3-.8-.9-.2-1.7-.5-1.7-1.2 0-.3.2-.7.4-1.1.3-.6.6-1.3.4-1.9-.2-.5-.8-.7-1.4-.9-.8-.3-1.8-.5-2-1.2-.1-.5.3-.9.8-1.2.4-.3 1.2-.4 1.6-1 .3-.5.2-1.1.2-2 0-2.6 2.1-4.7 4.7-4.7Z"/></svg>
            </a>
            <a href="#" aria-label="Instagram">
                <svg viewBox="0 0 24 24" role="img" aria-hidden="true"><path d="M7 3h10a4 4 0 0 1 4 4v10a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V7a4 4 0 0 1 4-4Zm10 2H7a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2Zm-5 3.5A4.5 4.5 0 1 1 7.5 13 4.5 4.5 0 0 1 12 8.5Zm0 2A2.5 2.5 0 1 0 14.5 13 2.5 2.5 0 0 0 12 10.5ZM17.5 7.8a1 1 0 1 1-1-1 1 1 0 0 1 1 1Z"/></svg>
            </a>
            <a href="#" aria-label="Facebook">
                <svg viewBox="0 0 24 24" role="img" aria-hidden="true"><path d="M13 9h3V6h-3c-2.2 0-4 1.8-4 4v2H7v3h2v6h3v-6h3l1-3h-4v-2c0-.6.4-1 1-1Z"/></svg>
            </a>
            <a href="#" aria-label="Twitter">
                <svg viewBox="0 0 24 24" role="img" aria-hidden="true"><path d="M21.5 7.3c-.6.3-1.2.5-1.9.6.7-.4 1.2-1 1.4-1.8-.6.4-1.3.7-2.1.9A3.2 3.2 0 0 0 13.3 9c0 .3 0 .6.1.9-2.7-.1-5-1.4-6.6-3.4-.3.5-.4 1-.4 1.6 0 1.1.6 2.1 1.5 2.6-.5 0-1-.2-1.4-.4 0 1.6 1.1 2.9 2.6 3.2-.3.1-.6.1-.9.1-.2 0-.4 0-.6-.1.4 1.3 1.6 2.2 3 2.2A6.4 6.4 0 0 1 3 18.3a9 9 0 0 0 4.9 1.4c5.9 0 9.1-4.9 9.1-9.1v-.4c.6-.4 1.2-1 1.6-1.6Z"/></svg>
            </a>
        </div>
    </footer>

    <script>
        const leftBoxImage = document.getElementById('leftBoxImage');
        const leftBoxImageNext = document.getElementById('leftBoxImageNext');
        const donateBox = document.querySelector('.center-box');
        const volunteerBox = document.querySelector('.right-box');
        const actionRow = document.querySelector('.action-row');

        const mainImages = [
            'img/images/Main image/20170302-IMG_6802-3.jpg',
            'img/images/Main image/4800_Ethiopia_2019_CG-.jpg',
            'img/images/Main image/4832_Ethiopia_2019_CG-.jpg',
            'img/images/Main image/4920_Ethiopia_2019_CG-.jpg',
            'img/images/Main image/JS_20170804_3915.jpg',
            'img/images/Main image/Madagascar_2019_CG-2726.jpg',
            'img/images/Main image/Madagascar_2019_CG-3510.jpg',
            'img/images/Main image/Madagascar_2019_CG-3793.jpg',
            'img/images/Main image/Madagascar_2019_CG-4322.jpg',
            'img/images/Main image/Rwanda-2018-march-cw-cubbygraham-1299-2.jpg',
            'img/images/Main image/Zimbabwe_2022_CG-7466.jpg'
        ];

        const donateImages = [
            'img/images/Main image/7255_Ethiopia_2019_CG-.jpg',
            'img/images/Main image/JS_20170301_033622_preview.jpg',
            'img/images/Main image/charity_water_Tanzania_TaraShupePhotography_0258.jpg'
        ];

        const volunteerImages = [
            'img/images/Volunteer images/0207_Ethiopia_2019_CG-V3.jpg',
            'img/images/Volunteer images/8439_Ethiopia_2019_CG-V4.jpg',
            'img/images/Volunteer images/9229_Ethiopia_2019_CG-V2.jpg',
            'img/images/Volunteer images/Zimbabwe_2022_CG-9389 V1.jpg'
        ];

        let currentMainIndex = 0;
        let currentVolunteerIndex = 0;
        let currentDonateIndex = 0;
        let hoverTarget = null;
        let slideshowTimer;
        let volunteerTimer;
        let donateTimer;
        let isTransitioning = false;
        let pendingSwap = null;
        let lastMainIndex = 0;
        let prevMainIndex = 0;
        const SLIDE_DELAY_MS = 4000;
        const VOLUNTEER_DELAY_MS = 4000;
        const DONATE_DELAY_MS = 4000;

        const applyHorizontalSizing = (img) => {
            if (!img.complete || img.naturalWidth === 0) return;
            img.classList.toggle('is-horizontal', img.naturalWidth > img.naturalHeight);
        };

        const preloadImages = (sources) => {
            sources.forEach((src) => {
                const img = new Image();
                img.src = src;
            });
        };

        const startWipeTransition = () => {
            leftBoxImageNext.classList.remove('wipe-in');
            void leftBoxImageNext.offsetWidth;
            leftBoxImageNext.classList.add('wipe-in');
        };

        const swapImage = (src, altText) => {
            if (leftBoxImage.src.endsWith(src)) return;
            if (isTransitioning) {
                pendingSwap = { src, altText };
                return;
            }
            isTransitioning = true;
            leftBoxImageNext.src = src;
            leftBoxImageNext.alt = altText;
            const startSwap = () => {
                applyHorizontalSizing(leftBoxImageNext);
                startWipeTransition();
            };
            leftBoxImageNext.addEventListener('load', startSwap, { once: true });
            if (leftBoxImageNext.complete) {
                startSwap();
            }
            leftBoxImageNext.addEventListener('animationend', () => {
                leftBoxImage.src = src;
                leftBoxImage.alt = altText;
                applyHorizontalSizing(leftBoxImage);
                leftBoxImageNext.classList.remove('wipe-in');
                isTransitioning = false;
                if (pendingSwap) {
                    const nextSwap = pendingSwap;
                    pendingSwap = null;
                    swapImage(nextSwap.src, nextSwap.altText);
                }
            }, { once: true });
        };

        const showNextMainImage = () => {
            if (hoverTarget) return;
            swapImage(mainImages[currentMainIndex], 'Main Image');
            prevMainIndex = lastMainIndex;
            lastMainIndex = currentMainIndex;
            currentMainIndex = (currentMainIndex + 1) % mainImages.length;
        };

        const getRandomMainIndex = (excludeIndices) => {
            if (mainImages.length <= 2) return 0;
            let nextIndex = excludeIndices[0];
            while (excludeIndices.includes(nextIndex)) {
                nextIndex = Math.floor(Math.random() * mainImages.length);
            }
            return nextIndex;
        };

        const showRandomMainImage = () => {
            const nextIndex = getRandomMainIndex([lastMainIndex, prevMainIndex]);
            swapImage(mainImages[nextIndex], 'Main Image');
            prevMainIndex = lastMainIndex;
            lastMainIndex = nextIndex;
            currentMainIndex = (nextIndex + 1) % mainImages.length;
        };

        const scheduleNextSlide = () => {
            clearTimeout(slideshowTimer);
            slideshowTimer = setTimeout(() => {
                showNextMainImage();
                scheduleNextSlide();
            }, SLIDE_DELAY_MS);
        };

        const getNextVolunteerImage = () => {
            const image = volunteerImages[currentVolunteerIndex];
            currentVolunteerIndex = (currentVolunteerIndex + 1) % volunteerImages.length;
            return image;
        };

        const getNextDonateImage = () => {
            const image = donateImages[currentDonateIndex];
            currentDonateIndex = (currentDonateIndex + 1) % donateImages.length;
            return image;
        };

        const startVolunteerSlideshow = () => {
            clearInterval(volunteerTimer);
            volunteerTimer = setInterval(() => {
                if (hoverTarget !== 'volunteer') return;
                swapImage(getNextVolunteerImage(), 'Volunteer Image');
            }, VOLUNTEER_DELAY_MS);
        };

        const stopVolunteerSlideshow = () => {
            clearInterval(volunteerTimer);
        };

        const startDonateSlideshow = () => {
            clearInterval(donateTimer);
            donateTimer = setInterval(() => {
                if (hoverTarget !== 'donate') return;
                swapImage(getNextDonateImage(), 'Donate Image');
            }, DONATE_DELAY_MS);
        };

        const stopDonateSlideshow = () => {
            clearInterval(donateTimer);
        };

        preloadImages(mainImages);
        preloadImages(volunteerImages);
        preloadImages(donateImages);
        applyHorizontalSizing(leftBoxImage);
        applyHorizontalSizing(leftBoxImageNext);
        scheduleNextSlide();

        const isMovingToActionBox = (event) => {
            const nextTarget = event.relatedTarget;
            if (!nextTarget) return false;
            return donateBox.contains(nextTarget) || volunteerBox.contains(nextTarget);
        };

        donateBox.addEventListener('mouseenter', () => {
            hoverTarget = 'donate';
            clearTimeout(slideshowTimer);
            stopVolunteerSlideshow();
            swapImage(getNextDonateImage(), 'Donate Image');
            startDonateSlideshow();
        });

        donateBox.addEventListener('mouseleave', (event) => {
            if (isMovingToActionBox(event)) return;
            hoverTarget = null;
            stopDonateSlideshow();
            showRandomMainImage();
            scheduleNextSlide();
        });

        volunteerBox.addEventListener('mouseenter', () => {
            hoverTarget = 'volunteer';
            clearTimeout(slideshowTimer);
            stopDonateSlideshow();
            swapImage(getNextVolunteerImage(), 'Volunteer Image');
            startVolunteerSlideshow();
        });

        volunteerBox.addEventListener('mouseleave', (event) => {
            if (isMovingToActionBox(event)) return;
            hoverTarget = null;
            stopVolunteerSlideshow();
            stopDonateSlideshow();
            showRandomMainImage();
            scheduleNextSlide();
        });

        actionRow.addEventListener('mouseleave', () => {
            if (!hoverTarget) return;
            hoverTarget = null;
            stopVolunteerSlideshow();
            stopDonateSlideshow();
            showRandomMainImage();
            scheduleNextSlide();
        });
    </script>
</body>
</html>
